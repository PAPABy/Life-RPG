<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Life RPG</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{
  background:#0b0f1a;
  color:white;
  font-family:Arial,sans-serif;
  padding:20px;
}
.card{
  background:#11162a;
  border-radius:24px;
  padding:20px;
  max-width:500px;
  margin:auto;
  position:relative;
}
h1{text-align:center}

/* AVATAR */
.avatar{
  width:90px;height:90px;
  border-radius:50%;
  margin:10px auto;
  background:linear-gradient(135deg,#00ffcc,#0066ff);
  display:flex;align-items:center;justify-content:center;
  font-size:40px;
  position:relative;
}
.avatar img{
  width:100%;height:100%;
  border-radius:50%;object-fit:cover;
}

/* AURA */
.avatar::after{
  content:"";
  position:absolute;
  inset:-8px;
  border-radius:50%;
  filter:blur(12px);
  opacity:0;
  z-index:-1;
}
.avatar.aura-apprentice::after{background:#2ecc71;opacity:.7}
.avatar.aura-warrior::after{background:#3498db;opacity:.9;animation:pulse 2s infinite}
.avatar.aura-master::after{background:#f1c40f;opacity:1;animation:pulseStrong 1.6s infinite}

@keyframes pulse{0%{transform:scale(.9)}50%{transform:scale(1.1)}100%{transform:scale(.9)}}
@keyframes pulseStrong{0%{transform:scale(.9)}50%{transform:scale(1.25)}100%{transform:scale(.9)}}

/* BUTTONS */
.uploadBtn,.reset-avatar-btn,.dev-reset-btn{
  width:100%;margin-top:8px;padding:8px;
  border-radius:12px;font-size:14px;
}
.uploadBtn{background:#1f2440;text-align:center}
.reset-avatar-btn{
  background:transparent;border:1px solid #2a3058;color:#bfc6ff;
}
.reset-avatar-btn:hover{background:#1a1f3c;color:#00ffcc}
.dev-reset-btn{
  background:#2a2f55;border:1px dashed #ff6b6b;color:#ffbaba;
}

/* TABS */
.tabs{display:flex;gap:10px;margin:10px 0 20px}
.tabs button{
  flex:1;background:#1f2440;border:none;color:white;
  padding:8px;border-radius:10px;
}
.tabs button.active{background:#00ffcc;color:black}

/* RANK */
.rank{text-align:center;margin-bottom:10px;color:#00ffcc}
.rank-up{animation:rankPop .8s}
@keyframes rankPop{0%{transform:scale(.8);opacity:0}40%{transform:scale(1.3);opacity:1}100%{transform:scale(1)}}

/* EXP */
.exp-bar{height:14px;background:#1f2440;border-radius:10px;overflow:hidden}
.exp-fill{height:100%;background:linear-gradient(90deg,#ffd700,#ff9f00);transition:.3s}
.level{text-align:center;font-size:14px;margin:6px 0 20px}

/* QUEST */
.quest{
  background:#1a1f3c;padding:12px;border-radius:14px;
  margin-bottom:10px;display:flex;justify-content:space-between;
}

/* LEVEL UP FX */
.level-up-fx{
  position:absolute;inset:0;
  display:flex;align-items:center;justify-content:center;
  font-size:32px;font-weight:bold;
  color:#ffd700;opacity:0;pointer-events:none;
}
.level-up-fx.show{animation:levelText 1s}
@keyframes levelText{
  0%{opacity:0;transform:scale(.6)}
  30%{opacity:1;transform:scale(1.2)}
  100%{opacity:0}
}

/* AI & MOOD */
.ai-coach,.mood-box{
  margin-top:20px;padding:14px;border-radius:18px;
  background:#141a33;border:1px solid #2a3058;
}
.mood-options{display:flex;justify-content:space-between}
.mood-options button{
  font-size:22px;background:#1f2440;border:none;
  border-radius:12px;padding:8px;
}
.mood-options button.active{background:#00ffcc}
</style>
</head>

<body>
<div class="card">
<div id="levelUpFx" class="level-up-fx">LEVEL UP!</div>

<div class="avatar" id="avatar">üßô</div>

<label class="uploadBtn">
Ganti Avatar
<input type="file" id="avatarUpload" hidden>
</label>

<button id="resetAvatar" class="reset-avatar-btn">‚ôªÔ∏è First Profile</button>

<h1>Life RPG</h1>
<div id="rankText" class="rank">RANK: NOVICE</div>

<div class="tabs">
<button id="tabStats" class="active">Stats</button>
<button id="tabGame">Game</button>
</div>

<div id="statsMode"></div>

<div class="mood-box">
<div>üå§Ô∏è Mood Hari Ini</div>
<div class="mood-options">
<button data-mood="great">üòÑ</button>
<button data-mood="good">üôÇ</button>
<button data-mood="neutral">üòê</button>
<button data-mood="tired">üò´</button>
<button data-mood="bad">üòî</button>
</div>
</div>

<div class="ai-coach">
<div id="aiMessage">Mulai bangun karaktermu hari ini.</div>
</div>

<div id="gameMode" style="display:none">
<div class="exp-bar"><div id="expFill" class="exp-fill"></div></div>
<div id="levelText" class="level"></div>
<div id="quests"></div>

<button onclick="devResetDay()">üîÑ Dev: Reset Day</button>
<button onclick="devResetGame()" class="dev-reset-btn">üß™ Dev: Reset Level Game</button>
</div>
</div>

<script>
/* ===== CORE STATE ===== */
const STORAGE="life_rpg_full";
let currentMood="neutral";
let avatarData=null;
let saveTimer;

/* SAVE (THROTTLED) */
function save(){
  clearTimeout(saveTimer);
  saveTimer=setTimeout(()=>{
    localStorage.setItem(STORAGE,JSON.stringify({stats,game,avatar:avatarData,mood:currentMood}));
  },300);
}

/* LOAD */
const saved=localStorage.getItem(STORAGE);
let stats={discipline:5,physical:5,financial:5,mental:5,social:5,relationship:5};
let game={level:1,exp:0,expMax:100,completed:{},lastDay:new Date().toDateString()};

if(saved){
  const d=JSON.parse(saved);
  stats=d.stats||stats;
  game=d.game||game;
  avatarData=d.avatar||null;
  currentMood=d.mood||"neutral";
}

/* EXP */
function getExpGain(){return game.level>=8?50:25}

/* LEVEL UP FX */
function triggerLevelUpFX(){
  document.getElementById("levelUpFx").classList.add("show");
  setTimeout(()=>levelUpFx.classList.remove("show"),1000);
}

/* QUEST */
const quests=[
{id:"discipline",text:"Discipline Task"},
{id:"physical",text:"Physical Activity"},
{id:"mental",text:"Mental Care"},
{id:"social",text:"Social Interaction"}
];

function completeQuest(id){
  if(game.completed[id])return;
  game.completed[id]=true;
  game.exp+=getExpGain();
  if(game.exp>=game.expMax){
    game.exp-=game.expMax;
    game.level++;
    game.expMax=Math.floor(game.expMax*1.25);
    triggerLevelUpFX();
  }
  updateGameUI();renderQuests();save();
}

function renderQuests(){
  questsBox.innerHTML="";
  quests.forEach(q=>{
    const done=game.completed[q.id];
    questsBox.innerHTML+=`
    <div class="quest">
    <span>${q.text} (+${getExpGain()} EXP)</span>
    <button ${done?"disabled":""} onclick="completeQuest('${q.id}')">${done?"‚úì":"Done"}</button>
    </div>`;
  });
}

/* UI */
const questsBox=document.getElementById("quests");
function updateGameUI(){
  expFill.style.width=(game.exp/game.expMax*100)+"%";
  levelText.innerText=`Level ${game.level} ‚Ä¢ ${game.exp}/${game.expMax}`;
}

/* AVATAR */
function updateAvatar(){
  const el=avatar;
  if(avatarData){
    el.innerHTML=`<img src="${avatarData}">`;
    return;
  }
  el.textContent="üßô";
}

/* EVENTS */
avatarUpload.onchange=e=>{
  const r=new FileReader();
  r.onload=()=>{avatarData=r.result;updateAvatar();save()};
  r.readAsDataURL(e.target.files[0]);
};
resetAvatar.onclick=()=>{avatarData=null;updateAvatar();save()};

/* INIT */
renderQuests();
updateAvatar();
updateGameUI();
</script>
</body>
</html>
