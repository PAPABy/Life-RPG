<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Life RPG</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  background:#0b0f1a;
  color:white;
  font-family:Arial, sans-serif;
  padding:20px;
}

.card {
  background:#11162a;
  border-radius:24px;
  padding:20px;
  max-width:500px;
  margin:auto;
}

.avatar img{
  width:100%;
  height:100%;
  border-radius:50%;
  object-fit:cover;
}

.avatar {
  width:90px;
  height:90px;
  border-radius:50%;
  margin:10px auto;
  background:linear-gradient(135deg,#00ffcc,#0066ff);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:40px;
}

h1 { text-align:center; }

.tabs {
  display:flex;
  gap:10px;
  margin:10px 0 20px;
}

.tabs button {
  flex:1;
  background:#1f2440;
  border:none;
  color:white;
  padding:8px;
  border-radius:10px;
}

.tabs button.active {
  background:#00ffcc;
  color:black;
}

.rank {
  text-align:center;
  margin-bottom:10px;
  color:#00ffcc;
}

/* EXP */
.exp-bar {
  height:14px;
  background:#1f2440;
  border-radius:10px;
  overflow:hidden;
}

.exp-fill {
  height:100%;
  background:linear-gradient(90deg,#ffd700,#ff9f00);
  width:0%;
  transition:.3s;
}

.level {
  text-align:center;
  font-size:14px;
  margin:6px 0 20px;
}

.quest {
  background:#1a1f3c;
  padding:12px;
  border-radius:14px;
  margin-bottom:10px;
  display:flex;
  justify-content:space-between;
  align-items:center;
}

.quest button {
  background:#00ffcc;
  border:none;
  border-radius:8px;
  padding:6px 10px;
}

/* STATS */
.stat {
  margin-bottom:18px;
}

.label {
  display:flex;
  justify-content:space-between;
  font-size:14px;
  margin-bottom:6px;
}

.bar {
  height:12px;
  background:#1f2440;
  border-radius:10px;
  overflow:hidden;
}

.fill {
  height:100%;
  border-radius:10px;
  transition:.3s;
}

.uploadBtn{
  display:block;
  margin:10px auto;
  padding:6px 12px;
  background:#1f2440;
  border-radius:10px;
  text-align:center;
  font-size:14px;
}

.reset-avatar-btn{
  width:100%;
  margin-top:10px;
  padding:8px 12px;
  background:transparent;
  border:1px solid #2a3058;
  color:#bfc6ff;
  border-radius:12px;
  font-size:14px;
  display:flex;
  align-items:center;
  justify-content:center;
  gap:6px;
  cursor:pointer;
  transition:all .2s ease;
}

.reset-avatar-btn:hover{
  background:#1a1f3c;
  color:#00ffcc;
  border-color:#00ffcc;
}

input[type=range] {
  width:100%;
  margin-top:8px;
}
/* ===== LEVEL UP EFFECT ===== */
.level-up-fx{
  position:absolute;
  inset:0;
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:32px;
  font-weight:bold;
  color:#ffd700;
  background:radial-gradient(circle, rgba(255,215,0,0.15), transparent 60%);
  opacity:0;
  pointer-events:none;
  z-index:5;
}

.card.level-up{
  animation:cardGlow 1s ease;
}

.card.level-up .avatar{
  animation:auraPulse 1s ease;
}

@keyframes cardGlow{
  0%{ box-shadow:0 0 0 rgba(255,215,0,0); }
  50%{ box-shadow:0 0 40px rgba(255,215,0,.8); }
  100%{ box-shadow:0 0 0 rgba(255,215,0,0); }
}

@keyframes auraPulse{
  0%{ transform:scale(1); box-shadow:0 0 0 rgba(0,255,204,0); }
  50%{ transform:scale(1.1); box-shadow:0 0 25px rgba(0,255,204,.9); }
  100%{ transform:scale(1); box-shadow:0 0 0 rgba(0,255,204,0); }
}

.level-up-fx.show{
  animation:levelText 1s ease;
}

@keyframes levelText{
  0%{ opacity:0; transform:scale(.6); }
  30%{ opacity:1; transform:scale(1.2); }
  100%{ opacity:0; transform:scale(1); }
}
/* ===== RANK ANIMATION ===== */
.rank{
  transition:color .3s ease;
}

.rank.rank-up{
  animation:rankPop .8s ease;
}

@keyframes rankPop{
  0%{ transform:scale(.8); opacity:0; }
  40%{ transform:scale(1.3); opacity:1; }
  100%{ transform:scale(1); }
}

/* WARNA TIAP RANK */
.rank.novice{ color:#7f8c8d; }
.rank.apprentice{ color:#2ecc71; }
.rank.warrior{ color:#3498db; }
.rank.master{
  color:#f1c40f;
  text-shadow:0 0 10px rgba(241,196,15,.8);
}

/* ===== AVATAR AURA BY RANK ===== */
.avatar{
  position:relative;
  z-index:2;
}

/* AURA BASE */
.avatar::after{
  content:"";
  position:absolute;
  inset:-8px;
  border-radius:50%;
  opacity:0;
  z-index:-1;
  filter:blur(12px);
  transition:opacity .3s ease;
}

/* APPRENTICE */
.avatar.aura-apprentice::after{
  background:rgba(46,204,113,.8);
  opacity:.8;
}

/* WARRIOR */
.avatar.aura-warrior::after{
  background:rgba(52,152,219,.9);
  opacity:.9;
  animation:auraPulse 2s infinite;
}

/* MASTER */
.avatar.aura-master::after{
  background:rgba(241,196,15,1);
  opacity:1;
  animation:auraPulseStrong 1.6s infinite;
}

@keyframes auraPulse{
  0%{ transform:scale(.9); }
  50%{ transform:scale(1.1); }
  100%{ transform:scale(.9); }
}

@keyframes auraPulseStrong{
  0%{ transform:scale(.9); }
  50%{ transform:scale(1.25); }
  100%{ transform:scale(.9); }
}
.dev-reset-btn{
  width:100%;
  margin-top:8px;
  padding:8px;
  background:#2a2f55;
  color:#ffbaba;
  border:1px dashed #ff6b6b;
  border-radius:12px;
  font-size:14px;
}

/* ===== AI COACH ===== */
.ai-coach{
  margin-top:20px;
  padding:14px;
  border-radius:18px;
  background:linear-gradient(135deg,#1a1f3c,#10162f);
  border:1px solid #2a3058;
}

.ai-title{
  font-size:14px;
  color:#00ffcc;
  margin-bottom:6px;
}

.ai-message{
  font-size:14px;
  line-height:1.4;
  color:#e0e6ff;
}

/* ===== MOOD INPUT ===== */
.mood-box{
  margin-top:20px;
  padding:14px;
  border-radius:18px;
  background:#141a33;
  border:1px solid #2a3058;
}

.mood-title{
  font-size:14px;
  margin-bottom:8px;
  color:#bfc6ff;
}

.mood-options{
  display:flex;
  justify-content:space-between;
}

.mood-options button{
  font-size:22px;
  background:#1f2440;
  border:none;
  border-radius:12px;
  padding:8px 10px;
  cursor:pointer;
  transition:.2s;
}

.mood-options button.active,
.mood-options button:hover{
  background:#00ffcc;
}
</style>
</head>

<body>

<div class="card">
 <div id="levelUpFx" class="level-up-fx">LEVEL UP!</div>
 <div class="avatar" id="avatar">üßô</div>
<label class="uploadBtn">
  Ganti Avatar
  <input type="file" accept="image/*" id="avatarUpload" hidden>
</label>
<button id="resetAvatar" class="reset-avatar-btn">
  ‚ôªÔ∏è First Profile
</button>

  <h1>Life RPG</h1>
  <div class="rank" id="rankText">RANK: NOVICE</div>

  <div class="tabs">
    <button id="tabStats" class="active">Stats</button>
    <button id="tabGame">Game</button>
  </div>

  <!-- STATS MODE -->
  <div id="statsMode"></div>
  
  <div class="mood-box">
  <div class="mood-title">üî• Mode Hardcore</div>
  <button id="hardcoreToggle" class="reset-avatar-btn">
    OFF
  </button>
  </div>
  
  <div class="mood-box">
  <div class="mood-title">üå§Ô∏è Mood Hari Ini</div>
  <div class="mood-options">
    <button data-mood="great">üòÑ</button>
    <button data-mood="good">üôÇ</button>
    <button data-mood="neutral">üòê</button>
    <button data-mood="tired">üò´</button>
    <button data-mood="bad">üòî</button>
  </div>
</div>

  <div id="aiCoach" class="ai-coach">
  <div class="ai-title">ü§ñ AI Coach</div>
  <div id="aiMessage" class="ai-message">
    Mulai bangun karaktermu hari ini.
  </div>
</div>

  <!-- GAME MODE -->
  <div id="gameMode" style="display:none">
    <div class="exp-bar"><div class="exp-fill" id="expFill"></div></div>
    <div class="level" id="levelText"></div>

    <h3>Daily Quests</h3>
    <div id="quests"></div>

    <button onclick="devResetDay()" style="margin-top:10px;width:100%">
      üîÑ Dev: Reset Day
    </button>
  <button onclick="devNextDay()" style="margin-top:10px;width:100%">
  üß™ Dev: Next Day
</button>
    <button onclick="devResetGame()" class="dev-reset-btn">
  üß™ Dev: Reset Level Game
</button>
     <button onclick="devResetSimulatedDay()" style="width:100%">
  üß™ Dev: Real Day
</button>
  </div>
</div>

<script>
/* ================== CONSTANT ================== */
const STORAGE = "life_rpg_full";
const hardcoreBtn = document.getElementById("hardcoreToggle");

/* ================== DATA DEFAULT ================== */
const statConfig = {
  discipline:{label:"Discipline",color:"#4facfe"},
  physical:{label:"Physical",color:"#ff4d4d"},
  financial:{label:"Financial",color:"#ffd700"},
  mental:{label:"Mental",color:"#b983ff"},
  social:{label:"Social",color:"#2ecc71"},
  relationship:{label:"Relationship",color:"#ff6fae"}
};

let stats = {};
Object.keys(statConfig).forEach(k => stats[k] = 5);

let game = {
  level:1,
  exp:0,
  expMax:100,
  completed:{},
  lastDay:new Date().toDateString()
};

let avatarData = null;
let isHardcore = false;
let devSimulatedDate = null; // hanya untuk dev
let currentMood = "neutral";
let lastRank = null;

function updateHardcoreUI(){
  hardcoreBtn.innerText = isHardcore ? "ON" : "OFF";
  hardcoreBtn.style.color = isHardcore ? "#ff6b6b" : "#bfc6ff";
  hardcoreBtn.style.borderColor = isHardcore ? "#ff6b6b" : "#2a3058";
}

hardcoreBtn.onclick = ()=>{
  isHardcore = !isHardcore;
  updateHardcoreUI();
  save();
};

/* ================== LOAD STORAGE ================== */
const saved = localStorage.getItem(STORAGE);
if(saved){
  const data = JSON.parse(saved);
  stats = data.stats || stats;
  game = data.game || game;
  avatarData = data.avatar || null;
  currentMood = data.mood || "neutral";
  isHardcore = data.hardcore || false;
}

/* ================== DOM CACHE ================== */
const statsMode = document.getElementById("statsMode");
const gameMode  = document.getElementById("gameMode");
const tabStats  = document.getElementById("tabStats");
const tabGame   = document.getElementById("tabGame");
const avatarEl  = document.getElementById("avatar");
const rankText  = document.getElementById("rankText");
const expFill   = document.getElementById("expFill");
const levelText = document.getElementById("levelText");
const aiMessage = document.getElementById("aiMessage");

/* ================== SAVE ================== */
function save(){
  localStorage.setItem(STORAGE, JSON.stringify({
    stats,
    game,
    avatar: avatarData,
    mood: currentMood,
    hardcore: isHardcore
  }));
}

/*================ Check Day ================ */
function applyHardcorePenalty(){
  if(!isHardcore) return;

  game.exp = Math.max(0, game.exp - 30);

  if(game.exp === 0 && game.level > 1){
    game.level--;
    game.expMax = Math.max(100, Math.floor(game.expMax / 1.25));
  }
}

function checkDay(){
  const today = new Date().toDateString();

  if(game.lastDay !== today){

    // üî• HARDCORE PENALTY
    if(isHardcore){
      const totalQuests = quests.length;
      const completedQuests = Object.keys(game.completed).length;

      if(completedQuests < totalQuests){
        applyHardcorePenalty();
      }
    }

    // RESET DAY
    game.completed = {};
    game.lastDay = today;

    updateGameUI();
    renderQuests();
    save();
  }
}

function checkDay(){
const today=new Date().toDateString();
if(game.lastDay!==today){
if(isHardcore && Object.keys(game.completed).length<quests.length){
applyHardcorePenalty();
}
game.completed={};
game.lastDay=today;
renderQuests();
updateGameUI();
save();
}
}

/* ================== MOOD ================== */
document.querySelectorAll(".mood-options button").forEach(btn=>{
  btn.onclick = ()=>{
    document.querySelectorAll(".mood-options button")
      .forEach(b=>b.classList.remove("active"));

    btn.classList.add("active");
    currentMood = btn.dataset.mood;

    updateAICoach();
    save();
  };

  if(btn.dataset.mood === currentMood){
    btn.classList.add("active");
  }
});

/* ================== AI COACH ================== */
function updateAICoach(){
  let lowestKey = null;
  let lowestValue = Infinity;

  for(const k in stats){
    if(stats[k] < lowestValue){
      lowestValue = stats[k];
      lowestKey = k;
    }
  }

  if(!lowestKey) return;

  const statName = statConfig[lowestKey].label;
  let text = "";

  if(currentMood === "great")
    text = `Energi kamu bagus. Dorong ${statName} hari ini.`;
  else if(currentMood === "good")
    text = `Sedikit progres di ${statName} akan terasa besar.`;
  else if(currentMood === "neutral")
    text = `Hari biasa. Fokus ringan pada ${statName}.`;
  else if(currentMood === "tired")
    text = `Pelan-pelan ya. Rawat ${statName} tanpa memaksa.`;
  else
    text = `Hari berat. Jaga ${statName}. Kamu tidak sendirian.`;

  aiMessage.innerText = text;
}

/* ================== LEVEL UP FX ================== */
function triggerLevelUpFX(){
  const card = document.querySelector(".card");
  const fx = document.getElementById("levelUpFx");

  card.classList.add("level-up");
  fx.classList.add("show");

  setTimeout(()=>{
    card.classList.remove("level-up");
    fx.classList.remove("show");
  },1000);
}

/* ================== STATS ================== */
function createStat(k){
  const s = statConfig[k];
  const div = document.createElement("div");
  div.className="stat";
  div.innerHTML=`
    <div class="label">
      <span>${s.label}</span>
      <span id="${k}Value"></span>
    </div>
    <div class="bar">
      <div class="fill" id="${k}Bar" style="background:${s.color}"></div>
    </div>
    <input id="${k}Input" type="range" min="0" max="10" step="0.1">
  `;
  statsMode.appendChild(div);

  document.getElementById(k+"Input").oninput=e=>{
    stats[k]=parseFloat(e.target.value);
    updateStatUI(k);
    updateRank();
    updateAvatar();
    updateAICoach();
    save();
  };

  updateStatUI(k);
}

function updateStatUI(k){
  document.getElementById(k+"Value").innerText = stats[k].toFixed(1);
  document.getElementById(k+"Bar").style.width = (stats[k]*10)+"%";
  document.getElementById(k+"Input").value = stats[k];
}

/* ================== GAME ================== */
const quests = [
  {id:"discipline",text:"Discipline Task"},
  {id:"physical",text:"Physical Activity"},
  {id:"mental",text:"Mental Care"},
  {id:"social",text:"Social Interaction"}
];

function getExpGain(){
  return game.level >= 8 ? 37 : 25;
}

function updateGameUI(){
  expFill.style.width = (game.exp/game.expMax*100)+"%";
  levelText.innerText = `Level ${game.level} ‚Ä¢ EXP ${game.exp} / ${game.expMax}`;
}

function completeQuest(id){
  if(game.completed[id]) return;

  game.completed[id]=true;
  game.exp += getExpGain();

  while(game.exp >= game.expMax){
    game.exp -= game.expMax;
    game.level++;
    game.expMax = Math.floor(game.expMax*1.25);
    triggerLevelUpFX();
  }

  updateRank();
  renderQuests();
  updateGameUI();
  updateAICoach();
  save();
}

function renderQuests(){
  const qbox = document.getElementById("quests");
  qbox.innerHTML="";
  quests.forEach(q=>{
    const done = game.completed[q.id];
    const div = document.createElement("div");
    div.className="quest";
    div.innerHTML=`
      <span>${q.text} (+${getExpGain()} EXP)</span>
      <button ${done?"disabled":""}>${done?"‚úì":"Done"}</button>
    `;
    div.querySelector("button").onclick=()=>completeQuest(q.id);
    qbox.appendChild(div);
  });
}

/* ================== DEV TOOLS ================== */
function devResetDay(){
  game.completed = {};
  game.lastDay = new Date().toDateString();

  renderQuests();
  updateGameUI();
  updateAICoach();
  save();

  alert("‚úÖ Daily quest berhasil di-reset");
}

function devResetGame(){
  if(!confirm("‚ö†Ô∏è Reset LEVEL & EXP?\nStats & Avatar tetap aman.")) return;

  game.level = 1;
  game.exp = 0;
  game.expMax = 100;
  game.completed = {};
  game.lastDay = new Date().toDateString();

  updateGameUI();
  updateRank();
  renderQuests();
  updateAICoach();
  save();

  alert("üß™ Level game berhasil di-reset");
}

function devNextDay(){
  const base = devSimulatedDate
    ? new Date(devSimulatedDate)
    : new Date(game.lastDay);

  base.setDate(base.getDate() + 1);
  devSimulatedDate = base.toDateString();

  alert("üß™ Dev: Hari diganti ke\n" + devSimulatedDate);

  checkDay();
  renderQuests();
  updateGameUI();
}

function devResetSimulatedDay(){
  devSimulatedDate = null;
  alert("Dev date kembali ke hari asli");
}

/* ================== RANK ================== */
function updateRank(){
  const avg = Object.values(stats).reduce((a,b)=>a+b,0)/Object.keys(stats).length;

  let rank="NOVICE", cls="novice";
  if(avg>=3){rank="APPRENTICE";cls="apprentice";}
  if(avg>=6){rank="WARRIOR";cls="warrior";}
  if(avg>=9){rank="MASTER";cls="master";}

  if(lastRank && lastRank!==rank){
    rankText.classList.add("rank-up");
    setTimeout(()=>rankText.classList.remove("rank-up"),800);
  }

  rankText.className = "rank "+cls;
  rankText.innerText = "RANK: "+rank;

  avatarEl.classList.remove("aura-apprentice","aura-warrior","aura-master");
  if(rank==="APPRENTICE") avatarEl.classList.add("aura-apprentice");
  if(rank==="WARRIOR") avatarEl.classList.add("aura-warrior");
  if(rank==="MASTER") avatarEl.classList.add("aura-master");

  lastRank = rank;
}

/* ================== AVATAR ================== */
function updateAvatar(){
  avatarEl.innerHTML="";
  if(avatarData){
    const img=document.createElement("img");
    img.src=avatarData;
    avatarEl.appendChild(img);
    return;
  }

  const avg = Object.values(stats).reduce((a,b)=>a+b,0)/Object.keys(stats).length;
  avatarEl.textContent = avg>=9?"üëë":avg>=6?"üõ°Ô∏è":avg>=3?"üßô":"üßç";
}

document.getElementById("avatarUpload").onchange=e=>{
  const file=e.target.files[0];
  if(!file) return;
  const reader=new FileReader();
  reader.onload=()=>{
    avatarData=reader.result;
    updateAvatar();
    save();
  };
  reader.readAsDataURL(file);
};

document.getElementById("resetAvatar").onclick=()=>{
  avatarData=null;
  updateAvatar();
  save();
};

/* ================== TABS ================== */
tabStats.onclick=()=>{
  statsMode.style.display="block";
  gameMode.style.display="none";
  tabStats.classList.add("active");
  tabGame.classList.remove("active");
};

tabGame.onclick=()=>{
  statsMode.style.display="none";
  gameMode.style.display="block";
  tabGame.classList.add("active");
  tabStats.classList.remove("active");
};

/* ================== INIT ================== */
Object.keys(statConfig).forEach(createStat);
renderQuests();
updateAvatar();
updateRank();
updateGameUI();
updateAICoach();
updateHardcoreUI();
checkDay();
tabStats.click();
</script>

</body>
</html>
